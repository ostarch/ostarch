#!/bin/bash
#--------------------------------------------------------------------
#   ██████╗ ███████╗████████╗     █████╗ ██████╗  ██████╗██╗  ██╗
#  ██╔═══██╗██╔════╝╚══██╔══╝    ██╔══██╗██╔══██╗██╔════╝██║  ██║
#  ██║   ██║███████╗   ██║       ███████║██████╔╝██║     ███████║
#  ██║   ██║╚════██║   ██║       ██╔══██║██╔══██╗██║     ██╔══██║
#  ╚██████╔╝███████║   ██║       ██║  ██║██║  ██║╚██████╗██║  ██║
#   ╚═════╝ ╚══════╝   ╚═╝       ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝
#--------------------------------------------------------------------

if [ $(whoami) = "root"  ]; then
  echo "Don't run this as root!"
  exit
fi

applyWallpaper() {
  plasma-apply-wallpaperimage /usr/share/wallpapers/Next
}

errors=0
until applyWallpaper
do
  if [[ $errors -ge 10 ]]; then
    break
  fi
  sleep 1.5
  errors=$((errors+1))
done

sleep 1.5
applyWallpaper

rm ~/.config/autostart/wallpaper-post-startup.desktop &> /dev/null
